{{#power-calendar center=month daysComponent='calendar-days' as |calendar|}}
  {{#paper-card class='person-card' as |card|}}
    {{#card.content}}
      <header>
        <div class='person-session'>You are logged in as {{person.email}}</div>
        {{#if showPerson}}
          <div>
            {{#paper-button class='cancel' onClick='cancel'}}Cancel{{/paper-button}}
            {{#paper-button class='submit' primary=person.hasDirtyAttributes raised=person.hasDirtyAttributes onClick='savePerson'}}Save{{/paper-button}}
          </div>
        {{else}}
          {{paper-button class='toggle' label='Edit details' onClick=(action (mut showPerson) (not showPerson))}}
        {{/if}}
      </header>
      {{#if showPerson}}
        {{#paper-form onSubmit=save as |form|}}
          {{#paper-radio-group
            groupValue=(readonly person.medium)
            onChange=(action (mut person.medium)) as |group|}}
            <div class='layout-row'>
              <div class='layout-column flex-50'>
                {{form.input class='name' label='Name' value=person.name onChange=(action (mut person.name)) errors=person.validationErrors.name isTouched=person.validationErrors.name.length}}
              </div>
              <div class='layout-column flex-50'>
                {{#paper-switch value=person.active onChange=(action (mut person.active) (not person.active))}}Available for rides{{/paper-switch}}
              </div>
            </div>
            <div class='layout-row'>
              <div class='layout-column flex-50'>
                <div class='layout-row text-radio mobile'>
                  {{form.input type='mobile' label='Mobile' value=person.mobile onChange=(action (mut person.mobile)) errors=person.validationErrors.mobile isTouched=person.validationErrors.mobile.length}}
                  {{#group.radio value='mobile'}}preferred{{/group.radio}}
                </div>
                <div class='layout-row text-radio landline'>
                  {{form.input type='mobile' label='Landline' value=person.landline onChange=(action (mut person.landline)) errors=person.validationErrors.landline isTouched=person.validationErrors.landline.length}}
                  {{#group.radio value='landline'}}preferred{{/group.radio}}
                </div>
              </div>
              <div class='layout-column email flex-50'>
                <div class='layout-row text-radio'>
                  {{form.input type='email' label='Email' disabled=true value=person.email onChange=(action (mut person.email)) errors=person.validationErrors.email isTouched=person.validationErrors.email.length}}
                  {{#group.radio value='email'}}preferred{{/group.radio}}
                </div>
              </div>
            </div>
          {{/paper-radio-group}}
        {{/paper-form}}
      {{/if}}
    {{/card.content}}
  {{/paper-card}}

  {{#paper-card class='subscription-card' as |card|}}
    {{#card.content}}
      <header>
        <div>Subscribe to a calendar that tracks your slot commitments and rides</div>
        {{#paper-button class='toggle' onClick=(action (mut showSubscription) (not showSubscription))}}
          {{#if showSubscription}}
            Hide information
          {{else}}
            More information
          {{/if}}
        {{/paper-button}}
      </header>
      {{#if showSubscription}}
        <p>Please be careful with this link, as it shows contact information for riders. If itâ€™s ever exposed, let us know and we can change the secret token.
        <a href={{subscriptionUrl}}>Subscribe</a></p>
      {{/if}}
    {{/card.content}}
  {{/paper-card}}

  {{calendar.nav}}

  {{#calendar.days showDaysAround=false as |day|}}
    {{calendar-day day=day slots=slots person=person}}
  {{/calendar.days}}
{{/power-calendar}}
