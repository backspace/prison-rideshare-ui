{{toolbar-header title='Record ride details'}}

{{#paper-content class='layout-column'}}
  {{#if model}}
    <div class='form-container'>
      {{#paper-form onSubmit=(action 'submit') as |form|}}
        <div class='layout layout-sm-column'>
          {{#paper-radio-group
            groupValue=(readonly rideProxy.content)
            onChange=(action 'setRide') as |group|}}
            {{#each (sort-by 'start' model) as |ride|}}
              {{#group.radio value=ride}}
                {{#if ride.initials}}{{ride.initials}}: {{/if}}{{moment-format ride.start 'ddd, MMM D [at] h:mma'}} to {{ride.institution.name}}
              {{/group.radio}}
            {{/each}}
          {{/paper-radio-group}}
        </div>

        <div class='layout-column'>
          {{form.input class='distance'
                       type='number'
                       label='Distance in kilometres'
                       value=rideProxy.distance
                       errors=rideProxy.validationErrors.distance
                       isTouched=(readonly rideProxy.validationErrors.distance.length)
                       onChange=(action (mut rideProxy.distance))}}
        </div>
        {{#if rideProxy.donatable}}
          <div class='layout layout-sm-column'>
            {{#paper-checkbox
              value=rideProxy.donation
              onChange=(action (mut rideProxy.donation))}}Donate your gas reimbursement{{/paper-checkbox}}
          </div>
        {{/if}}
        <div class='layout-column'>
          {{form.input class='food-expenses'
                       type='number'
                       label='Food expenses if wanting reimbursement'
                       value=rideProxy.foodExpensesDollars
                       onChange=(action (mut rideProxy.foodExpensesDollars))}}
        </div>
        <div class='layout-column'>
          {{#form.input class='report-notes'
                       textarea=true
                       label='Notes'
                       value=rideProxy.reportNotes
                       onChange=(action (mut rideProxy.reportNotes)) as |textHelper|}}
            {{#unless textHelper.hasValue}}
              <div class="hint">Anything unusual, like paying the driver for gas instead of car owner.</div>
            {{/unless}}
          {{/form.input}}
        </div>

        <div class="layout-row">
          {{#paper-button class='submit'
                          raised=true primary=true
                          onClick=(action 'submit')}}Save{{/paper-button}}
                          {{! FIXME simplify if/when form yields radio-group?}}
        </div>
      {{/paper-form}}
    </div>
  {{else}}
    {{#paper-card class='no-rides' as |card|}}
      {{#card.content}}
        There are no rides to report on! Thanks for your diligence, drivers. Email us if you expected to see a report here.
      {{/card.content}}
    {{/paper-card}}
  {{/if}}
{{/paper-content}}
