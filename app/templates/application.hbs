{{head-layout}}
{{ember-load-remover}}

{{paper-toaster}}

{{#paper-sidenav-container class='site-nav-container'}}
  {{#paper-sidenav lockedOpen='gt-sm'
    open=this.sidebar.open
    onToggle=(action (mut this.sidebar.open))}}

    {{#paper-content}}
      {{#paper-list}}
        {{#if this.session.currentUser.admin}}
          {{#paper-item}}
            {{#link-to 'drivers'}}<span>Drivers</span>{{/link-to}}
          {{/paper-item}}
          {{#paper-item}}
            {{#link-to 'reimbursements'}}<span>Reimbursements</span>{{/link-to}}
          {{/paper-item}}
          {{#paper-item}}
            {{#link-to 'debts'}}<span>Debts</span>{{/link-to}}
          {{/paper-item}}
          {{#paper-item}}
            {{#link-to 'rides'}}
              <span class='rides'>
                <span>Rides</span>
                {{#if this.ridesBadgeCount}}<span class='count' title='How many rides require attention'>{{this.ridesBadgeCount}}</span>{{/if}}
              </span>
            {{/link-to}}
          {{/paper-item}}
          {{#paper-item}}
            {{#link-to 'institutions'}}<span>Institutions</span>{{/link-to}}
          {{/paper-item}}
          {{#paper-item}}
            {{#link-to 'admin-calendar' (moment-format (now) 'YYYY-MM')}}<span>Calendar</span>{{/link-to}}
          {{/paper-item}}
          {{#paper-item}}
            {{#link-to 'statistics'}}<span>Statistics</span>{{/link-to}}
          {{/paper-item}}
        {{/if}}
        {{#paper-item}}
          {{#link-to 'reports.new'}}<span>Report</span>{{/link-to}}
        {{/paper-item}}
        {{#paper-item}}
          {{#link-to 'gas-prices'}}<span>Gas prices</span>{{/link-to}}
        {{/paper-item}}
        {{#if this.session.isAuthenticated}}
          {{#if this.session.currentUser.admin}}
            {{#paper-item}}
              {{#link-to 'log'}}
                <span class='log'>
                  <span>Log</span>
                  {{#if this.sidebar.unreadCount}}<span class='count' title='How many unread posts you have'>{{this.sidebar.unreadCount}}</span>{{/if}}
                </span>
              {{/link-to}}
            {{/paper-item}}
            {{#paper-item}}
              {{#link-to 'users'}}
                <span class='users'>
                  <span>Users</span>
                  {{#if this.sidebar.userCount}}<span class='count' title='How many users are connected'>{{this.sidebar.userCount}}</span>{{/if}}
                </span>
              {{/link-to}}
            {{/paper-item}}
            {{paper-divider}}
          {{/if}}
          {{#paper-item onClick=(action 'logout') class='session'}}
            Log out {{this.session.currentUser.email}}
          {{/paper-item}}
        {{else}}
          {{#paper-item}}
            {{#link-to 'login'}}<span>Admin log in</span>{{/link-to}}
          {{/paper-item}}
        {{/if}}
      {{/paper-list}}
    {{/paper-content}}
  {{/paper-sidenav}}

  <main class='flex layout-column'>
    {{outlet}}
  </main>
{{/paper-sidenav-container}}
